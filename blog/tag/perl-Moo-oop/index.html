<!DOCTYPE html>
<html>
    <head>
        <link href="/theme/css/normalize.css" rel="stylesheet">
        <link href="/theme/css/skeleton.css" rel="stylesheet">
        <link href="/theme/css/statocles-default.css" rel="stylesheet">
        <title>TADEGENBAN</title>
        <link href="/blog/tag/perl-Moo-oop.atom" rel="alternate" type="application/atom+xml">
        <link href="/blog/tag/perl-Moo-oop.rss" rel="alternate" type="application/rss+xml">
        
    </head>
    <body>
        <header>
            <nav class="navbar">
                <div class="container">
                    <a class="brand" href="/">TADEGENBAN</a>
                    <ul>
                        <li>
                            <a href="/">Blog</a>
                        </li>
                        <li>
                            <a href="/about.html">About</a>
                        </li>
                        <li>
                            <a href="/index_slides.html">Slides</a>
                        </li>
                    </ul>
                </div>
            </nav>
            
        </header>
        <div class="main container">
            
<div class="row">

    <div class="nine columns">
        <main>


            <article>
                <header>
                    <h1><a href="/blog/2014/10/11/moo-introduction.html">用Moo来写面向对象perl</a></h1>

                    <p class="tags">Tags:
                        <a href="/blog/tag/perl-Moo-oop/" rel="tag">perl Moo oop</a>
                    </p>

                    <aside>
                        <p><time datetime="2014-10-11">
                            Posted on 2014-10-11
                        </time>
                            by tadegenban
                        </p>
                    </aside>

                </header>

                <h2>Moose 大家庭</h2>

<p>perl的原生的面向对象是比较简单的，通过bless关键字和hash来建立对象，很灵活但也很简陋</p>

<p>自从出现了Moose之后，perl的面向对象就很富有表现力了。</p>

<p>Moose -&gt; Moos -&gt; Moo -&gt; Mo -&gt; M, 再加上Mouse， 构成了Moose大家庭</p>

<p>从Moose到M依次功能递减， M 代表 nothing， 在不太复杂的项目一般用Moo就足够了</p>

<p>这里简单介绍一下Moo的用法</p>

<h2>Moo -- 轻量级面向对象</h2>

<p>比如我要建立一个Person对象，用Moo可以这么写:</p>

<pre><code>package Person;
use Moo;

has name =&gt; is =&gt; &#39;rw&#39;;
has age  =&gt; is =&gt; &#39;rw&#39;;

sub intro {
    my $self = shift;
    print &quot;My name is &quot;. $self-&gt;name;
}
</code></pre>

<p>在你的代码里就可以这么建立一个Person对象:</p>

<pre><code>use Person;

my $lip = Person-&gt;new(name =&gt; &#39;lip&#39;, age =&gt; 18 );
$lip-&gt;intro();
</code></pre>

<p>和perl的原生OOP一样，一个package就是一个对象。</p>

<p>Moo提供了一个<code>has</code>关键字，用来定义属性</p>

<pre><code>has name =&gt; is =&gt; &#39;rw&#39;;
</code></pre>

<p>表示属性<code>name</code> 是 可读可写 的，如果写成<code>&#39;ro&#39;</code>就表示是只读的</p>

<p><code>sub intro</code> 定义了一个方法， <code>$self</code> 是指代实例本身， <code>$self-&gt;name</code> 就可以得到name属性的值</p>

<p>下面详细介绍一些Moo的特性</p>

<h2>属性定义 -- has</h2>

<pre><code>has attr =&gt; is =&gt; &#39;rw&#39;, default =&gt; &#39;default&#39;;
</code></pre>

<p>or</p>

<p>has attr =&gt; (
       is =&gt; &#39;rw&#39;,
       default =&gt; &#39;default&#39;,
       )</p>

<p>因为小括号只是起到分组的作用，所以两种写法都是一样的。</p>

<p>has 的 options 有：</p>

<p>is(必要的) : 可以是&#39;rw&#39; 读写, &#39;ro&#39; 只读, &#39;lazy&#39; 惰性</p>

<p>isa : 用来定义这个属性的类型， 比如：</p>

<pre><code>isa =&gt; sub { die &quot;$_[0] is not a number!&quot; unless looks_like_number $_[0] }
</code></pre>

<p>就确保该属性是一个数字。</p>

<p>default:  默认值，需要注意的是这里一般是传个匿名函数作为值，比如你要默认值为一个空数组引用：</p>

<pre><code>default =&gt; sub { [] };
</code></pre>

<p>builder : 这个一般配合lazy使用，在lazy=1时，属性的值不会在对象建立的时候建立，而是在第一次求值的时候调用builder来计算</p>

<p>lazy :  如上</p>

<p>reader/writer : 你可以定义一个reader给属性， 比如 get_attr， 定义一个writer为 set_attr</p>

<pre><code>            只是相比$self-&gt;attr既是读又是写，来的更浅显
</code></pre>

<h2>对象继承 -- extends</h2>

<h2>方法修改器 -- before after around</h2>



            </article>
        </main>

        <ul class="pager">
            <li class="prev">
                <a class="button disabled" href="" rel="next">
                    ← Older
                </a>
            </li>
            <li class="next">
                <a class="button disabled" href="" rel="prev">
                    Newer →
                </a>
            </li>
        </ul>

    </div>

    <div class="three columns sidebar">
        
        <h1>Tags</h1>
        <ul class="list-inline">
            <li><a href="/blog/tag/Pegex/">Pegex</a></li>
            <li><a href="/blog/tag/emacs/">emacs</a></li>
            <li><a href="/blog/tag/perl/">perl</a></li>
            <li><a href="/blog/tag/perl-Moo-oop/">perl Moo oop</a></li>
        </ul>
        <h1>Feeds</h1>
        <ul class="list-inline">
            <li>
                <a href="/blog/tag/perl-Moo-oop.atom" rel="alternate" type="application/atom+xml">
                    Atom
                </a>
            </li>
            <li>
                <a href="/blog/tag/perl-Moo-oop.rss" rel="alternate" type="application/rss+xml">
                    RSS
                </a>
            </li>
        </ul>
    </div>

</div>

        </div>
        <footer>
            
            <div class="container tagline">
                <a href="http://preaction.github.io/Statocles">Made with Statocles</a><br>
                <a href="http://www.perl.org">Powered by Perl</a>
            </div>
        </footer>
    </body>
</html>
